# diff

> 手写diff算法

## 新老节点替换的规则

1. 如果新老节点不是同一个节点名称，那么就暴力删除旧的节点，创建插入新的节点
2. 只能同级比较，不能跨层比较。如果跨层那么就暴力删除旧的节点，创建插入新的节点。
3. 如果是相同节点，又分为很多情况
   1. 如果新的节点没有children，那就证明新节点是文本，那直接把新的替换成旧的文本
   2. 新的节点有children，旧的也有children --> 就是diff算法的核心了
      1. 旧前 和 新前
         - 匹配：旧前的指针++、新前的指针++
      2. 旧后 和 新后
         - 匹配：旧后的指针--、新后的指针--
      3. 旧前 和 新后
         - 匹配：旧前的指针++、新后的指针--
      4. 旧后 和 新前
         - 匹配：旧后的指针--、新前的指针++
      5. 以上都不满足添加 --> 查找
         - 新的指针++，新的添加到页面并且新的在旧的有，要给旧的赋值成undefined
      6. 创建或删除
   3. 新的节点有children，旧的没有-->创建元素添加（把旧的内容删除清空掉，增加新的）

*注意：如果要提升性能，一定要加入key，key是唯一标识，在更改前后，确认是不是同一节点*
